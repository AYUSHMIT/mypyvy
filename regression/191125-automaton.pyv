# MYPYVY: typecheck --no-print-counterexample --no-query-time --error-filename-basename --no-print-cmdline --print-exit-code
sort A

mutable relation R(A)
mutable relation S(A, A)

init !S(X,Y)

transition t(x: A, y: A)
  modifies S
  (R(x) <-> x = y) &
  (forall X,Y. new(S(X,Y)) <-> S(X,Y) | X = x & Y = y)

automaton {
  init phase p1

  phase p1
    transition t -> self assume R(x)
    transition t -> phase p2 assume !R(x)
    safety S(X,Y) -> X = Y

  phase p2
    transition t -> self
}
